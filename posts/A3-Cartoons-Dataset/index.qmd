---
title: "A3 - Cartoons Dataset"
author: "Gayatri Jadhav"
prof: "Arvind Venkatadri"
---

## Introduction

This dataset shows ratings given by MAHE students to different cartoons. Each entry includes a Participant ID, Gender, Cartoon name, and Rating. The aim is to see if there are significant differences in how people rate each cartoon. By using ANOVA, we can find out if some cartoon is consistently rated higher or lower than the other.

```{r}
#| label: setup
library(tidyverse) # Tidy data processing
library(ggformula) # Formula based plots
library(mosaic) # Data inspection and Statistical Inference
library(broom) # Tidy outputs from Statistical Analyses
library(infer) # Statistical Inference, Permutation/Bootstrap
library(patchwork) # Arranging Plots
library(ggprism) # Interesting Categorical Axes
library(supernova) # Beginner-Friendly ANOVA Tables
```

```{r}
# Reading in the data
cartoon <- read_csv("../../Data/Cartoon.csv")

glimpse(cartoon)

```

```{r}
# Mutating by converting Gender and Cartoon into factors

cartoon_modified <- cartoon %>%
  dplyr::mutate(
  Gender = as_factor(Gender),
  Cartoon = as_factor(Cartoon)
  )
glimpse(cartoon_modified)
```

```{r}
# Set graph theme
theme_set(new = theme_classic())
##
gf_histogram(~Rating,
  fill = ~Cartoon,
  data = cartoon_modified, alpha = 0.5
) %>%
  gf_vline(xintercept = ~ mean(Rating)) %>%
  gf_labs(
    title = "Histograms of Cartoon Ratings Distributions",
    x = "Rating", y = "Count"
  ) %>%
  gf_text(11 ~ (mean(cartoon_modified$Rating) + 1.5),
    label = "Overall Mean"
  ) %>%
  gf_refine(guides(fill = guide_legend(title = "Cartoon")))
```

```{r}
# Set graph theme
theme_set(new = theme_classic())

# Creating faceted histograms with black outline, and overall mean line
gf_histogram(~Rating,
  data = cartoon_modified, alpha = 0.7, bins = 10,
  fill = ~Cartoon, color = "black"  # Black outline
) %>%
  gf_facet_wrap(~Cartoon) %>%  # Facet by cartoon
  gf_vline(xintercept = mean(~Rating, data = cartoon_modified), linetype = "dashed") %>%
  gf_labs(
    title = "Histograms of Cartoon Ratings Distributions by Cartoon",
    x = "Rating", y = "Count"
  ) 
```

::: callout-note
I tried facetting by cartoon, this way each cartoonâ€™s rating distribution can be observed independently, making it easier to spot whether the cartoon has ratings clustered around high or low values. It also easy to compare how each cartoon's ratings match up with the overall mean.
:::

```{r}
# Set graph theme
theme_set(new = theme_classic())
##
gf_boxplot(
  data = cartoon_modified,
  Rating ~ Cartoon,
  fill = ~ Cartoon,
  alpha = 0.5
) %>%
   gf_vline(xintercept = mean(cartoon_modified$Rating)) %>%
  gf_labs(
    title = "Boxplots of Cartoon Ratings vs Cartoon",
    x = "Cartoon", y = "Rating",
    caption = "Using ggprism"
  ) %>%
  gf_refine(
    scale_x_discrete(guide = "prism_bracket"),
    guides(fill = guide_legend(title = "Cartoon"))
  )
```

<https://av-quarto.netlify.app/content/courses/analytics/inference/modules/130-threemeansormore/>
